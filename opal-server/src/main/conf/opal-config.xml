<org.obiba.opal.core.cfg.OpalConfiguration>

  <secretKey>this will be generated during install</secretKey>

  <fileSystemRoot>file://${OPAL_HOME}/fs</fileSystemRoot>

  <functionalUnits>
  </functionalUnits>

  <magmaEngineFactory>

    <extensions>
      <org.obiba.magma.js.MagmaJsExtension />
      <org.obiba.magma.xstream.MagmaXStreamExtension />
      <org.obiba.magma.security.MagmaSecurityExtension />
    </extensions>

    <factories>
      <org.obiba.magma.datasource.hibernate.support.HibernateDatasourceFactory>
        <name>opal-keys</name>
        <sessionFactoryProvider class="org.obiba.magma.datasource.hibernate.support.SpringBeanSessionFactoryProvider">
          <beanName>keySessionFactory</beanName>
        </sessionFactoryProvider>
      </org.obiba.magma.datasource.hibernate.support.HibernateDatasourceFactory>
      <org.obiba.magma.datasource.hibernate.support.HibernateDatasourceFactory>
        <name>opal-data</name>
        <sessionFactoryProvider class="org.obiba.magma.datasource.hibernate.support.SpringBeanSessionFactoryProvider">
          <beanName>opalSessionFactory</beanName>
        </sessionFactoryProvider>
      </org.obiba.magma.datasource.hibernate.support.HibernateDatasourceFactory>
    </factories>
  </magmaEngineFactory>

  <extensions>
    <org.obiba.opal.datashield.cfg.DatashieldConfiguration>
      <aggregatingMethods>
        <org.obiba.opal.datashield.RFunctionDataShieldMethod>
          <name>length</name>
          <function>length</function>
        </org.obiba.opal.datashield.RFunctionDataShieldMethod>
        <org.obiba.opal.datashield.RFunctionDataShieldMethod>
          <name>coefficients</name>
          <function>coefficients</function>
        </org.obiba.opal.datashield.RFunctionDataShieldMethod>
        <org.obiba.opal.datashield.CustomRScriptMethod>
          <name>summary</name>
          <script><![CDATA[function(data) {
 if(is.vector(data) && length(data) == 1) {
   "Vector too small."
 } else {
   base::summary(data);
 }
}]]>
</script>
        </org.obiba.opal.datashield.CustomRScriptMethod>
        <org.obiba.opal.datashield.CustomRScriptMethod>
          <name>custom</name>
          <script>function(data) { "custom!" }</script>
        </org.obiba.opal.datashield.CustomRScriptMethod>
      </aggregatingMethods>
    </org.obiba.opal.datashield.cfg.DatashieldConfiguration>
  </extensions>
</org.obiba.opal.core.cfg.OpalConfiguration>